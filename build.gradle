// Build egg + pydocs with documentation
task buildFull() {}


// Run all tests
task doTests() {}

task bundleIncluded() {}

// Build just Python egg
task buildEgg(type:Exec) {

    commandLine 'python', 'setup.py', 'bdist_egg'
}

// Task to install local .egg
task installEgg(type:Exec) {

    commandLine 'python', 'setup.py', 'install'
}

// Task to generate documentation
task genDocs(type:Exec) {

    mkdir('docs')

    workingDir = './docs/'

    commandLine 'pydoc', '-w', "../dtf/*.py"
}

// Flake8 the Code
task doFlake(type:Exec) {

    commandLine 'flake8', './dtf'
}

// pylint the Code
task doLint(type:Exec) {

    commandLine 'pylint', './dtf', '--rcfile=./pylint.config'
}

task deleteIncludedZip(type:Delete) {

    delete 'dtf/included.zip'
}

// Create ZIP bundle of included
task zipIncluded(type:Zip) {

    from ('included/')
    include '**/*'
    into ''
    archiveName 'included.zip'
    destinationDir file('dtf/')
}

// doTests will make sure the code passes all tests
doTests.dependsOn doLint
doTests.dependsOn doFlake

// buildEgg will produce a .egg installation
buildEgg.dependsOn doTests
buildEgg.dependsOn bundleIncluded

// buildFull creates an .egg and associated documentation
buildFull.dependsOn buildEgg
buildFull.dependsOn genDocs

// installEgg requires a valid .egg
installEgg.dependsOn buildEgg

// Bundling
bundleIncluded.dependsOn zipIncluded
zipIncluded.dependsOn deleteIncludedZip
